package.path = package.path .. ';luasocket/?.lua'
package.cpath = package.cpath .. ';luasocket/?.so'

local sys_print = print
local print = nil

local cjson = require("cjson")
local cjson_map = cjson:new()
cjson_map.encode_sparse_array(true, 1, 1)

require("redis")
require("util")
require("time")

local redis_host2 = "pt-activity.pwft0z.clustercfg.use1.cache.amazonaws.com"
local redis_port2 = 6379
local redis_pwd2 = ""

local activity_redis = Redis.connect(redis_host2, redis_port2)
if redis_pwd2 and redis_pwd2 ~= '' then
	redis:auth(redis_pwd2)
end

function print(...)

	local info = _G.debug.getinfo(2, "Sl")
	local file = info and info.short_src or "unknown"
	local line = info and info.currentline or 0

	sys_print(file .. ":" .. line, ...)
end

function get_user_activity_data(account, ac_key, start_time)

	local ac_data_key = "dpzj:activity_data:" .. account
	local ac_data = activity_redis:hget(ac_data_key, ac_key)

	local json = nil
	if ac_data and ac_data ~= "" then
		json = cjson.decode(ac_data)
		local time = json.start_time or nil

		if not time or time < start_time then
			json = nil
			activity_redis:hdel(ac_data_key, ac_key)
		end
	end

	json = json or {}

	return ac_data_key, json
end

function set_user_activity_data(ac_data_key, ac_key, ac_json)

	local now_json_str = cjson.encode(ac_json)

	activity_redis:hset(ac_data_key, ac_key, now_json_str)
end

function get_temp_attr(id, attr)

	local ac_key = "user_temp_data"
	local ac_data_key, ac_json = get_user_activity_data(id, ac_key, time.time("2020-12-21"))
	local now = os.time()

	local temp_attr_tab = ac_json.attr_tab or {}
	local temp_attr_time_tab = ac_json.attr_time or {}
	local endtime = temp_attr_time_tab[attr]
	if not endtime then
		return
	end

	if now > endtime then
		temp_attr_tab[attr] = nil
		temp_attr_time_tab[attr] = nil

		ac_json.start_time = now
		ac_json.attr_tab = temp_attr_tab
		ac_json.attr_time = temp_attr_time_tab

		set_user_activity_data(ac_data_key, ac_key, ac_json)
		return
	end

	return temp_attr_tab[attr]
end

function set_temp_attr(id, attr, val, delay_time, bool_flush)

	if delay_time < 0 then
		return
	end
	local ac_key = "user_temp_data"
	local ac_data_key, ac_json = get_user_activity_data(id, ac_key, time.time("2020-12-21"))
	local now = os.time()

	local temp_attr_tab = ac_json.attr_tab or {}
	temp_attr_tab[attr] = val

	local temp_attr_time_tab = ac_json.attr_time or {}
	if not temp_attr_time_tab[attr] or now > temp_attr_time_tab[attr] or bool_flush then
		temp_attr_time_tab[attr] = now + delay_time
	end

	ac_json.start_time = now
	ac_json.attr_tab = temp_attr_tab
	ac_json.attr_time = temp_attr_time_tab
	local now_json_str = cjson.encode(ac_json)
	activity_redis:hset(ac_data_key, ac_key, now_json_str)
end

local tab_fix = {
{	1450630	,	489407	},
{	1272458	,	1947816	},
{	240130	,	1460173	},
{	909456	,	1333852	},
{	240130	,	1870936	},
{	224165	,	1882575	},
{	1450630	,	1906851	},
{	1272458	,	419538	},
{	1648056	,	455184	},
{	224165	,	1959534	},
{	1324783	,	1448705	},
{	224165	,	1896834	},
{	224165	,	1852585	},
{	224165	,	1859839	},
{	1272458	,	1721006	},
{	1450630	,	1730390	},
{	1450630	,	1940056	},
{	784704	,	1747490	},
{	1648056	,	1306006	},
{	1450630	,	1822604	},
{	1192698	,	1771138	},
{	224165	,	1949731	},
{	1192698	,	1857348	},
{	224165	,	117862	},
{	1450630	,	1780051	},
{	1450630	,	734097	},
{	1450630	,	611136	},
{	1014713	,	1938403	},
{	1780051	,	1794975	},
{	224165	,	1882589	},
{	200734	,	1171893	},
{	224165	,	1930967	},
{	1576772	,	1795926	},
{	1648056	,	1556233	},
{	1878275	,	1647930	},
{	1192698	,	1836129	},
{	614469	,	1813171	},
{	1450630	,	1945215	},
{	224165	,	1888647	},
{	224165	,	1225172	},
{	1834139	,	1353842	},
{	374234	,	1592859	},
{	1834139	,	1563249	},
{	1882575	,	1940055	},
{	899178	,	1202258	},
{	1450630	,	1909009	},
{	224165	,	393081	},
{	224165	,	1956064	},
{	1077691	,	1873244	},
{	1077691	,	1403988	},
{	1450630	,	1711506	},
{	1813171	,	1963200	},
{	1450630	,	1875286	},
{	308724	,	1884924	},
{	224165	,	1894739	},
{	899178	,	1703238	},
{	224165	,	894546	},
{	308724	,	394243	},
{	308724	,	765735	},
{	224165	,	493086	},
{	1876052	,	1050901	},
{	224165	,	1761963	},
{	224165	,	1765380	},
{	224165	,	1275665	},
{	1272458	,	1474053	},
{	1067052	,	1453604	},
{	224165	,	701012	},
{	1813171	,	105318	},
{	988717	,	214403	},
{	224165	,	611967	},
{	1272458	,	940502	},
{	995023	,	1138733	},
{	1077691	,	1825372	},
{	1940055	,	1813891	},
{	1876052	,	461153	},
{	1813171	,	1862864	},
{	240130	,	526673	},
{	240130	,	1500890	},
{	240130	,	958872	},
{	1450630	,	676783	},
{	909456	,	1946056	},
{	240130	,	433665	},
{	160996	,	1967285	},
{	240130	,	803407	},
{	909456	,	784704	},
{	1890552	,	470474	},
{	224165	,	1956196	},
{	1077691	,	1848131	},
{	224165	,	1909379	},
{	202176	,	1943485	},
{	1834139	,	1947127	},
{	224165	,	1630982	},
{	1890967	,	1892220	},
{	224165	,	1010980	},
{	1077691	,	1888225	},
{	1883328	,	1907190	},
{	894546	,	1957523	},
{	1067052	,	1846924	},
{	224165	,	1792276	},
{	308724	,	1324783	},
{	1813171	,	914890	},
{	1873244	,	1928402	},
{	1324783	,	1763753	},
{	224165	,	1844812	},
{	899178	,	1899583	},
{	224165	,	1638147	},
{	899178	,	1939776	},
{	308724	,	1218281	},
{	374234	,	1970568	},
{	160996	,	1970539	},
{	1890552	,	1924945	},
{	374234	,	1896705	},
{	1077691	,	1793617	},
{	160996	,	1287860	},
{	1834139	,	1767460	},
{	1883328	,	209831	},
{	240130	,	222095	},
{	1873244	,	1737032	},
{	1890552	,	1021651	},
{	374234	,	1935744	},
{	240130	,	1114271	},
{	240130	,	247931	},
{	224165	,	1773409	},
{	1883328	,	814919	},
{	224165	,	1927321	},
{	166912	,	1628145	},
{	1890552	,	1322763	},
{	308724	,	1665453	},
{	374234	,	1896070	},
{	1890967	,	1874965	},
{	160996	,	203899	},
{	240130	,	1560848	},
{	240130	,	122685	},
{	1014713	,	1847153	},
{	1813171	,	1577525	},
{	224165	,	101203	},
{	1940055	,	1972023	},
{	1813171	,	1942674	},
{	374234	,	1480679	},
{	240130	,	1947855	},
{	224165	,	1939142	},
{	202176	,	1934413	},
{	1077691	,	798392	},
{	240130	,	919339	},
{	101167	,	924553	},
{	1873244	,	1881084	},
{	909456	,	1010086	},
{	357045	,	1951693	},
{	1890552	,	1859273	},
{	1882575	,	1704151	},
{	1813171	,	1959817	},
{	240130	,	1814270	},
{	1067052	,	1174256	},
{	308724	,	1312628	},
{	1890552	,	270641	},
{	1272458	,	1793860	},
{	1450630	,	430912	},
{	240130	,	1624124	},
{	1890552	,	1938212	},
{	308724	,	1120877	},
{	1014713	,	1947465	},
{	988717	,	1473466	},
{	1450630	,	1056129	},
{	240130	,	1889213	},
{	1014713	,	537433	},
{	308724	,	1069654	},
{	1928614	,	1944442	},
{	1944442	,	1798047	},
{	1014713	,	1867252	},
{	240130	,	1696795	},
{	505246	,	1120257	},
{	240130	,	1557103	},
{	1834139	,	280905	},
{	899178	,	988717	},
{	374234	,	1002950	},
{	160996	,	891697	},
{	1272458	,	1007377	},
{	1883328	,	1700498	},
{	1883328	,	933448	},
{	1873244	,	1463330	},
{	1255783	,	1747928	},
{	1255783	,	1672718	},
{	909456	,	789794	},
{	1873244	,	1921582	},
{	308724	,	1340672	},
{	240130	,	1933746	},
{	1077691	,	1848966	},
{	1014713	,	846471	},
{	1077691	,	1834782	},
{	1450630	,	1964466	},
{	240130	,	1800647	},
{	1834139	,	308509	},
{	899178	,	909456	},
{	202176	,	1822855	},
{	374234	,	1216634	},
{	202176	,	1582453	},
{	1876052	,	1897145	},
{	374234	,	1290765	},
{	374234	,	1717899	},
{	1077691	,	560916	},
{	1450630	,	1907881	},
{	1450630	,	355176	},
{	505246	,	1402478	},
{	1014713	,	162616	},
{	1834139	,	1958635	},
{	1878275	,	1887227	},
{	1324783	,	623866	},
{	899178	,	1959106	},
{	308724	,	101243	},
{	374234	,	209991	},
{	224165	,	1961979	},
{	1813171	,	1771996	},
{	224165	,	1534110	},
{	1883328	,	1624990	},
{	374234	,	1959706	},
{	224165	,	1130194	},
{	166912	,	1840749	},
{	1014713	,	1914669	},
{	1077691	,	1473497	},
{	1077691	,	1816567	},
{	1876052	,	549091	},
{	909456	,	1870861	},
{	1661791	,	166912	},
{	909456	,	1941221	},
{	1077691	,	1664466	},
{	1834139	,	1960685	},
{	1077691	,	1487662	},
{	1834139	,	1895091	},
{	240130	,	1617887	},
{	374234	,	416321	},
{	160996	,	1728580	},
{	1883328	,	1020385	},
{	240130	,	187988	},
{	1077691	,	238804	},
{	899178	,	1097339	},
{	1077691	,	661057	},
{	240130	,	1464846	},
{	1014713	,	1846492	},
{	1014713	,	160996	},
{	240130	,	1253958	},
{	1813171	,	1825545	},
{	1253958	,	1464953	},
{	1077691	,	1439025	},
{	1883328	,	1272097	},
{	240130	,	1794573	},
{	1077691	,	1676748	},
{	240130	,	874040	},
{	240130	,	1968972	},
{	374234	,	1896666	},
{	1450630	,	1483930	},
{	1873244	,	1852523	},
{	240130	,	388784	},
{	160996	,	1627186	},
{	240130	,	1309236	},
{	224165	,	1772643	},
{	374234	,	1855429	},
{	224165	,	892514	},
{	1882575	,	1666553	},
{	224165	,	301003	},
{	166912	,	1962212	},
{	166912	,	1962218	},
{	224165	,	1265058	},
{	240130	,	1614601	},
{	1944442	,	419025	},
{	224165	,	1911513	},
{	1878275	,	1890229	},
{	614469	,	1410873	},
{	1077691	,	712218	},
{	614469	,	1743971	},
{	308724	,	1520935	},
{	1928614	,	1564522	},
{	202176	,	1880708	},
{	308724	,	1960455	},
{	1890552	,	1928614	},
{	374234	,	1445521	},
{	1255783	,	483861	},
{	240130	,	1962497	},
{	1014713	,	1704613	},
{	1077691	,	1447489	},
{	240130	,	588321	},
{	1876052	,	1861113	},
{	899178	,	1949838	},
{	1813171	,	978119	},
{	224165	,	1624165	},
{	909456	,	1016347	},
{	160996	,	1874519	},
{	374234	,	447311	},
{	899178	,	958543	},
{	1077691	,	801187	},
{	224165	,	1714761	},
{	1450630	,	1970183	},
{	1014713	,	1053016	},
{	1450630	,	489809	},
{	308724	,	116787	},
{	899178	,	1624138	},
{	1450630	,	1973463	},
{	224165	,	907956	},
{	909456	,	444369	},
{	988717	,	771369	},
{	1077691	,	744469	},
{	374234	,	1896226	},
{	909456	,	444396	},
{	374234	,	1967254	},
{	909456	,	1681280	},
{	240130	,	1947612	},
{	1883328	,	500172	},
{	1890552	,	1689975	},
{	224165	,	1763974	},
{	784704	,	1714311	},
{	1077691	,	1815321	},
{	1272458	,	932563	},
{	1255783	,	1284892	},
{	1077691	,	559326	},
{	1813171	,	1968847	},
{	224165	,	1272458	},
{	909456	,	1212492	},
{	374234	,	1003999	},
{	240130	,	1349824	},
{	1883328	,	594753	},
{	1878275	,	1971625	},
{	240130	,	1716079	},
{	224165	,	226896	},
{	614469	,	1248692	},
{	357045	,	1933583	},
{	240130	,	1744019	},
{	374234	,	976707	},
{	1077691	,	1030427	},
{	1450630	,	434096	},
{	899178	,	1625933	},
{	224165	,	578219	},
{	240130	,	1641857	},
{	240130	,	1936834	},
{	614469	,	1966669	},
{	160996	,	1142545	},
{	240130	,	1412262	},
{	224165	,	1867832	},
{	1255783	,	430882	},
{	1883328	,	1292450	},
{	899178	,	929026	},
{	240130	,	1919292	},
{	1944442	,	374813	},
{	240130	,	1747835	},
{	1873244	,	283326	},
{	1890552	,	291801	},
{	1014713	,	1682430	},
{	1661791	,	230568	},
{	224165	,	1622746	},
{	240130	,	1901877	},
{	1077691	,	1335169	},
{	1077691	,	1637974	},
{	308724	,	1187807	},
{	240130	,	112641	},
{	240130	,	1959911	},
{	374234	,	1882338	},
{	1883328	,	1930783	},
{	1890552	,	1816727	},
{	240130	,	1826799	},
{	1834139	,	1963925	},
{	1834139	,	1882702	},
{	100923	,	938845	},
{	308724	,	894657	},
{	308724	,	256545	},
{	224165	,	1960473	},
{	1014713	,	1848367	},
{	224165	,	152126	},
{	374234	,	985739	},
{	899178	,	1835621	},
{	1876052	,	1860732	},
{	308724	,	726877	},
{	240130	,	1919338	},
{	240130	,	1938621	},
{	308724	,	1423379	},
{	614469	,	1729338	},
{	1883328	,	1948416	},
{	1450630	,	1193589	},
{	1097339	,	1769917	},
{	240130	,	1424694	},
{	240130	,	747256	},
{	1077691	,	1840923	},
{	240130	,	1215290	},
{	909456	,	1378565	},
{	374234	,	404315	},
{	240130	,	1765502	},
{	240130	,	1593172	},
{	308724	,	1079087	},
{	224165	,	1620025	},
{	374234	,	1871919	},
{	224165	,	1686215	},
{	1077691	,	234122	},
{	988717	,	1598516	},
{	1014713	,	1765468	},
{	1014713	,	1946168	},
{	909456	,	588860	},
{	224165	,	1260231	},
{	224165	,	1877673	},
{	1834139	,	374122	},
{	1450630	,	1075363	},
{	224165	,	1971815	},
{	899178	,	479441	},
{	1077691	,	1192698	},
{	1834139	,	1958197	},
{	224165	,	1968721	},
{	1077691	,	1065850	},
{	1873244	,	1561984	},
{	1883328	,	1972132	},
{	224165	,	1651716	},
{	224165	,	1923493	},
{	224165	,	1820726	},
{	224165	,	1559612	},
{	202176	,	374234	},
{	1876052	,	1896366	},
{	374234	,	1207044	},
{	160996	,	236331	},
{	1873244	,	1837696	},
{	1324783	,	1443031	},
{	160996	,	1757997	},
{	1834139	,	1431411	},
{	224165	,	1491163	},
{	1876052	,	1382152	},
{	224165	,	1888503	},
{	224165	,	1838502	},
{	374234	,	1906188	},
{	988717	,	1896910	},
{	1813171	,	1701495	},
{	101167	,	1482404	},
{	1272458	,	1936605	},
{	1450630	,	915363	},
{	240130	,	1963539	},
{	899178	,	1973644	},
{	308724	,	1975898	},
{	374234	,	1041984	},
{	1097339	,	174696	},
{	1450630	,	440376	},
{	1077691	,	1870716	},
{	240130	,	1862881	},
{	224165	,	1971729	},
{	1192698	,	1534023	},
{	909456	,	1971417	},
{	240130	,	998745	},
{	374234	,	1962164	},
{	1272458	,	1927232	},
{	1944442	,	929434	},
{	240130	,	1949046	},
{	101167	,	201519	},
{	1834139	,	890799	},
{	240130	,	223828	},
{	160996	,	1975399	},
{	240130	,	1905943	},
{	1873244	,	647736	},
{	1014713	,	1879130	},
{	894546	,	1317710	},
{	1928614	,	1276342	},
{	240130	,	739389	},
{	1813171	,	1542292	},
{	1883328	,	1885353	},
{	240130	,	1957130	},
{	1813171	,	1474846	},
{	160996	,	1857161	},
{	240130	,	1431051	},
{	1077691	,	1938609	},
{	101167	,	1096873	},
{	374234	,	1090178	},
{	1813171	,	1827542	},
{	224165	,	1934491	},
{	1878275	,	934802	},
{	899178	,	1306961	},
{	224165	,	1573998	},
{	1813171	,	1867885	},
{	899178	,	1813177	},
{	1077691	,	1808399	},
{	1940055	,	1941595	},
{	166912	,	742201	},
{	240130	,	1927899	},
{	101167	,	1903845	},
{	308724	,	1443764	},
{	357045	,	1839568	},
{	224165	,	1338933	},
{	1077691	,	405724	},
{	1077691	,	1939318	},
{	1883328	,	1955906	},
{	202176	,	1219468	},
{	308724	,	1279041	},
{	308724	,	1729622	},
{	308724	,	200734	},
{	1014713	,	1972291	},
{	374234	,	949399	},
{	1077691	,	1819313	},
{	1890552	,	1868812	},
{	224165	,	1715296	},
{	899178	,	1198706	},
{	1878275	,	1890552	},
{	224165	,	198211	},
{	1077691	,	1534539	},
{	101167	,	1703460	},
{	1813171	,	1435328	},
{	899178	,	640994	},
{	160996	,	1156584	},
{	240130	,	1947503	},
{	374234	,	1792010	},
{	240130	,	1936488	},
{	101167	,	1859271	},
{	1272458	,	1741056	},
{	101167	,	278443	},
{	101167	,	532385	},
{	899178	,	1632630	},
{	1450630	,	1711289	},
{	374234	,	1326866	},
{	240130	,	972774	},
{	166912	,	860793	},
{	1450630	,	1850554	},
{	240130	,	1977418	},
{	1272458	,	1780592	},
{	240130	,	1731002	},
{	1834139	,	1036240	},
{	1834139	,	1943881	},
{	1834139	,	1864183	},
{	160996	,	1715065	},
{	1450630	,	707375	},
{	308724	,	1908424	},
{	894546	,	1113470	},
{	1890967	,	142353	},
{	1077691	,	1367479	},
{	308724	,	1977470	},
{	1890967	,	637231	},
{	240130	,	353112	},
{	1883328	,	1706288	},
{	1878275	,	1945680	},
{	308724	,	363480	},
{	160996	,	1094828	},
{	1834139	,	101353	},
{	1834139	,	1812564	},
{	240130	,	1793607	},
{	166912	,	1755492	},
{	1813171	,	1041476	},
{	240130	,	805241	},
{	1077691	,	884079	},
{	1628145	,	1969867	},
{	374234	,	1932731	},
{	240130	,	1945820	},
{	1883328	,	479144	},
{	240130	,	1881609	},
{	1813171	,	534757	},
{	308724	,	1275790	},
{	240130	,	1620120	},
{	101167	,	1835696	},
{	1192698	,	809552	},
{	1878275	,	248861	},
{	374234	,	1724012	},
{	166912	,	1839163	},
{	1834139	,	1872669	},
{	224165	,	477364	},
{	614469	,	1300417	},
{	899178	,	240825	},
{	166912	,	1906777	},
{	1077691	,	461758	},
{	240130	,	1555945	},
{	1014713	,	1930586	},
{	240130	,	1503281	},
{	1077691	,	1642996	},
{	894546	,	1969950	},
{	1928614	,	1419916	},
{	240130	,	1246327	},
{	240130	,	1819521	},
{	909456	,	350165	},
{	224165	,	253809	},
{	1272458	,	1591811	},
{	909456	,	1055232	},
{	1255783	,	171027	},
{	909456	,	1140684	},
{	100923	,	621384	},
{	1813171	,	1910306	},
{	1077691	,	483724	},
{	894546	,	1857463	},
{	1834139	,	1822833	},
{	224165	,	1553721	},
{	374234	,	1702957	},
{	166912	,	1862962	},
{	1813171	,	1909746	},
{	308724	,	352692	},
{	1928614	,	1436619	},
{	224165	,	1807608	},
{	308724	,	1976864	},
{	1873244	,	1632129	},
{	308724	,	1973450	},
{	1077691	,	915780	},
{	224165	,	1903056	},
{	100923	,	421730	},
{	240130	,	1976246	},
{	1077691	,	1721103	},
{	374234	,	1067052	},
{	240130	,	1932699	},
{	240130	,	612923	},
{	240130	,	1939084	},
{	894546	,	911936	},
{	240130	,	1885064	},
{	240130	,	1163782	},
{	374234	,	1968323	},
{	240130	,	1845459	},
{	240130	,	1938182	},
{	240130	,	1921022	},
{	1014713	,	1702942	},
{	308724	,	1788546	},
{	374234	,	1773725	},
{	357045	,	193859	},
{	1813171	,	1761130	},
{	1878275	,	1345388	},
{	100923	,	308724	},
{	374234	,	1899287	},
{	1813171	,	1968299	},
{	1077691	,	1852510	},
{	240130	,	1651471	},
{	101167	,	247105	},
{	1890552	,	1941356	},
{	1272458	,	1604736	},
{	909456	,	1939361	},
{	1272458	,	1771518	},
{	224165	,	461706	},
{	374234	,	1065005	},
{	100923	,	1615052	},
{	1878275	,	1978215	},
{	224165	,	1341984	},
{	240130	,	1008077	},
{	240130	,	1871780	},
{	240130	,	1552511	},
{	1077691	,	1717181	},
{	101167	,	1893091	},
{	1272458	,	1959829	},
{	240130	,	1799616	},
{	1014713	,	1565600	},
{	308724	,	1549166	},
{	240130	,	1960516	},
{	166912	,	1693251	},
{	1834139	,	1721167	},
{	1272458	,	1604749	},
{	308724	,	1675146	},
{	308724	,	1964314	},
{	1077691	,	1774395	},
{	308724	,	1971132	},
{	1077691	,	1784210	},
{	101167	,	1140137	},
{	308724	,	1970209	},
{	374234	,	1822528	},
{	240130	,	496470	},
{	1077691	,	1851931	},
{	224165	,	1974649	},
{	308724	,	1961341	},
{	1890552	,	1488894	},
{	308724	,	101287	},
{	1488894	,	1814230	},
{	224165	,	798747	},
{	224165	,	1877426	},
{	160996	,	1248053	},
{	308724	,	1977926	},
{	101167	,	1965243	},
{	1272458	,	1464035	},
{	224165	,	1382178	},
{	160996	,	882461	},
{	1450630	,	661858	},
{	100923	,	1747997	},
{	224165	,	1844020	},
{	899178	,	1141813	},
{	160996	,	813207	},
{	224165	,	880801	},
{	160996	,	1973145	},
{	308724	,	1760384	},
{	224165	,	1755830	},
{	899178	,	1756048	},
{	374234	,	1799774	},
{	224165	,	1859541	},
{	224165	,	1642858	},
{	224165	,	885038	},
{	160996	,	277403	},
{	224165	,	1834940	},
{	160996	,	1974441	},
{	160996	,	1978325	},
{	1450630	,	294332	},
{	202176	,	437070	},
{	1813171	,	1601469	},
{	224165	,	1980028	},
{	308724	,	1563895	},
{	240130	,	1678866	},
{	240130	,	1931862	},
{	240130	,	107226	},
{	240130	,	1765059	},
{	308724	,	1971330	},
{	374234	,	1658186	},
{	224165	,	869634	},
{	374234	,	1980075	},
{	224165	,	1948497	},
{	224165	,	240130	},
{	374234	,	1980074	},
{	1450630	,	254025	},
{	240130	,	592973	},
{	101167	,	1777445	},
{	240130	,	293666	},
{	160996	,	471923	},
{	240130	,	868170	},
{	240130	,	1930220	},
{	101167	,	1976201	},
{	160996	,	1935755	},
{	240130	,	1535509	},
{	166912	,	1929163	},
{	1928614	,	1950330	},
{	1928614	,	250802	},
{	784704	,	1521496	},
{	240130	,	1963291	},
{	1873244	,	1934407	},
{	909456	,	1904996	},
{	374234	,	1776247	},
{	240130	,	165265	},
{	1890967	,	1967917	},
{	240130	,	1181695	},
{	1883328	,	1902218	},
{	101167	,	1595915	},
{	614469	,	1980785	},
{	224165	,	1849463	},
{	160996	,	1963227	},
{	1077691	,	1201886	},
{	101167	,	1670783	},
{	1272458	,	542789	},
{	160996	,	481389	},
{	1014713	,	1808729	},
{	160996	,	1597751	},
{	1873244	,	1624008	},
{	1878275	,	1953216	},
{	160996	,	1980846	},
{	160996	,	1980718	},
{	240130	,	1978468	},
{	308724	,	794232	},
{	240130	,	1835288	},
{	240130	,	1887278	},
{	240130	,	208990	},
{	1873244	,	1849169	},
{	240130	,	1752593	},
{	240130	,	1930421	},
{	240130	,	386261	},
{	101167	,	761317	},
{	909456	,	1099975	},
{	202176	,	1520314	},
{	374234	,	1863920	},
{	1878275	,	1734773	},
{	1883328	,	1701640	},
{	202176	,	1972034	},
{	374234	,	1903597	},
{	374234	,	324907	},
{	1272458	,	630961	},
{	240130	,	1764898	},
{	1890967	,	1955325	},
{	240130	,	580283	},
{	1890967	,	1138757	},
{	240130	,	1704435	},
{	1192698	,	1797675	},
{	374234	,	1829361	},
{	374234	,	594072	},
{	308724	,	1977682	},
{	240130	,	1931764	},
{	166912	,	1911961	},
{	202176	,	1981626	},
{	308724	,	1798418	},
{	308724	,	1952593	},
{	240130	,	1719106	},
{	374234	,	1979419	},
{	1097339	,	1750195	},
{	1890552	,	265394	},
{	899178	,	1460915	},
{	308724	,	1734813	},
{	240130	,	1919768	},
{	240130	,	1796725	},
{	224165	,	237766	},
{	224165	,	1962418	},
{	240130	,	673136	},
{	240130	,	288652	},
{	308724	,	176384	},
{	240130	,	1666033	},
{	240130	,	256446	},
{	100923	,	1978594	},
{	224165	,	814412	},
{	1813171	,	1480282	},
{	166912	,	1612360	},
{	1878275	,	1378517	},
{	160996	,	930861	},
{	308724	,	1082092	},
{	101167	,	182375	},
{	240130	,	443791	},
{	200734	,	1861199	},
{	308724	,	1982092	},
{	1450630	,	1980967	},
{	1813171	,	1486271	},
{	374234	,	1853770	},
{	1272458	,	1421996	},
{	240130	,	1814192	},
{	1077691	,	1885257	},
{	240130	,	1833975	},
{	1834139	,	275112	},
{	374234	,	1272468	},
{	224165	,	1943998	},
{	1813171	,	1743982	},
{	101167	,	1982061	},
{	240130	,	1720166	},
{	1272458	,	1980749	},
{	308724	,	1931747	},
{	1014713	,	1808674	},
{	240130	,	1952889	},
{	1077691	,	1819429	},
{	988717	,	1108813	},
{	374234	,	1715796	},
{	1077691	,	1982360	},
{	909456	,	1811949	},
{	101167	,	1866859	},
{	101167	,	1948353	},
{	1077691	,	897314	},
{	240130	,	1599778	},
{	1813171	,	1766781	},
{	1255783	,	1371637	},
{	240130	,	1830353	},
{	240130	,	1881790	},
{	625948	,	1751541	},
{	240130	,	1740051	},
{	374234	,	768251	},
{	1192698	,	1396425	},
{	1077691	,	1850333	},
{	160996	,	518366	},
{	308724	,	1885840	},
{	224165	,	1852518	},
{	988717	,	1973207	},
{	240130	,	1736715	},
{	1878275	,	761821	},
{	505246	,	489964	},
{	240130	,	176193	},
{	894546	,	1109367	},
{	240130	,	678299	},
{	1834139	,	1218754	},
{	894546	,	1624098	},
{	101167	,	1141049	},
{	1878275	,	1022503	},
{	1272458	,	1963616	},
{	1077691	,	1888233	},
{	101167	,	1396278	},
{	100923	,	1975312	},
{	240130	,	1938116	},
{	224165	,	814220	},
{	1873244	,	1842649	},
{	374234	,	1408240	},
{	240130	,	1833171	},
{	240130	,	1921223	},
{	240130	,	458523	},
{	308724	,	648572	},
{	899178	,	1953849	},
{	240130	,	122658	},
{	1450630	,	1922912	},
{	240130	,	1614123	},
{	166912	,	1120873	},
{	240130	,	1839641	},
{	1272458	,	655056	},
{	240130	,	1440487	},
{	899178	,	1610682	},
{	101167	,	1512524	},
{	1813171	,	1815667	},
{	1077691	,	1589317	},
{	1450630	,	1845684	},
{	240130	,	447206	},
{	1813171	,	1976012	},
{	100923	,	1978488	},
{	1648056	,	1057368	},
{	1648056	,	1983962	},
{	1450630	,	1287865	},
{	101167	,	1983476	},
{	224165	,	1821957	},
{	1834139	,	1945295	},
{	224165	,	1457440	},
{	374234	,	759498	},
{	374234	,	1814756	},
{	1077691	,	1982137	},
{	1834139	,	770172	},
{	1878275	,	775537	},
{	1878275	,	859131	},
{	988717	,	1848850	},
{	1883328	,	1984753	},
{	909456	,	1706618	},
{	1077691	,	1755772	},
{	1272458	,	1725682	},
{	1192698	,	1703430	},
{	240130	,	521232	},
{	1014713	,	1980023	},
{	240130	,	486661	},
{	240130	,	1362344	},
{	625948	,	1609474	},
{	1878275	,	745203	},
{	1077691	,	1743298	},
{	1450630	,	1879900	},
{	1077691	,	496835	},
{	894546	,	1157852	},
{	224165	,	1887159	},
{	374234	,	1919912	},
{	1928614	,	1984888	},
{	224165	,	1409243	},
{	224165	,	723918	},
{	240130	,	1517240	},
{	240130	,	206423	},
{	1014713	,	1949365	},
{	240130	,	507793	},
{	200734	,	639792	},
{	240130	,	1523575	},
{	224165	,	1985317	},
{	1450630	,	412186	},
{	1077691	,	1985551	},
{	1834139	,	1945472	},
{	1450630	,	965454	},
{	1450630	,	1882599	},
{	224165	,	1985320	},
{	1077691	,	1940140	},
{	101167	,	1983467	},
{	1834139	,	1985670	},
{	224165	,	968557	},
{	101167	,	712585	},
{	200734	,	1536441	},
{	1878275	,	1984407	},
{	1873244	,	1881035	},
{	224165	,	847657	},
{	1834139	,	332648	},
{	1450630	,	1851885	},
{	1014713	,	1925598	},
{	166912	,	912672	},
{	224165	,	167830	},
{	166912	,	1402204	},
{	240130	,	1960448	},
{	1450630	,	1985749	},
{	1928614	,	1953672	},
{	894546	,	539804	},
{	240130	,	1980103	},
{	1883328	,	1975663	},
{	357045	,	1923781	},
{	1450630	,	1943305	},
{	240130	,	1949362	},
{	1873244	,	1957902	},
{	240130	,	1398393	},
{	1878275	,	1883342	},
{	1077691	,	1854088	},
{	1834139	,	1932581	},
{	1014713	,	1938071	},
{	240130	,	379905	},
{	1834139	,	1835096	},
{	308724	,	1382137	},
{	1878275	,	1985343	},
{	1883328	,	1987051	},
{	240130	,	1789879	},
{	1077691	,	1819025	},
{	240130	,	1787216	},
{	1883328	,	1909241	},
{	1450630	,	1597306	},
{	1255783	,	159088	},
{	1450630	,	1685680	},
{	1834139	,	1516376	},
{	240130	,	1858614	},
{	374234	,	242526	},
{	1813171	,	1823781	},
{	1813171	,	1901866	},
{	240130	,	1914302	},
{	224165	,	1957501	},
{	166912	,	1412402	},
{	1014713	,	1880060	},
{	1834139	,	1934583	},
{	1450630	,	1706953	},
{	240130	,	1505253	},
{	357045	,	1929333	},
{	909456	,	1961367	},
{	1450630	,	802792	},
{	166912	,	1671422	},
{	1878275	,	1212428	},
{	1890967	,	982707	},
{	166912	,	1903807	},
{	240130	,	1814877	},
{	909456	,	1713692	},
{	1878275	,	1880089	},
{	374234	,	1420907	},
{	1272458	,	1933660	},
{	1878275	,	1752583	},
{	308724	,	1725316	},
{	240130	,	1611085	},
{	1450630	,	1865440	},
{	1882575	,	1980543	},
{	240130	,	1809623	},
{	1834139	,	323790	},
{	374234	,	1858972	},
{	374234	,	1723894	},
{	899178	,	1689045	},
{	166912	,	765537	},
{	240130	,	1606587	},
{	240130	,	1070117	},
{	1878275	,	1932145	},
{	1014713	,	902285	},
{	240130	,	1319272	},
{	166912	,	1907539	},
{	1883328	,	239674	},
{	909456	,	1763053	},
{	1813171	,	995243	},
{	240130	,	1635052	},
{	240130	,	1826469	},
{	1813171	,	1819894	},
{	899178	,	1747513	},
{	1450630	,	457273	},
{	1014713	,	1266182	},
{	160996	,	1319224	},
{	1450630	,	578276	},
{	240130	,	1921630	},
{	1890967	,	1479206	},
{	224165	,	665523	},
{	1077691	,	271372	},
{	224165	,	1875200	},
{	899178	,	1988077	},
{	308724	,	1114576	},
{	224165	,	1939998	},
{	1878275	,	1988729	},
{	505246	,	284254	},
{	1450630	,	1684981	},
{	909456	,	1812252	},
{	1878275	,	1773445	},
{	614469	,	1440868	},
{	1834139	,	608792	},
{	101167	,	328751	},
{	1450630	,	168949	},
{	240130	,	927757	},
{	1878275	,	1985821	},
{	1834139	,	1945729	},
{	1883328	,	1915420	},
{	1450630	,	1199382	},
{	1648056	,	1928425	},
{	100923	,	1648056	},
{	1834139	,	1476699	},
{	1834139	,	1866101	},
{	1834139	,	1950938	},
{	308724	,	1873467	},
{	899178	,	859234	},
{	224165	,	1934363	},
{	224165	,	1832868	},
{	1873244	,	782789	},
{	224165	,	1939765	},
{	224165	,	1843932	},
{	1834139	,	1990877	},
{	1813171	,	1781845	},
{	909456	,	1908042	},
{	909456	,	1946628	},
{	909456	,	1961514	},
{	224165	,	1752485	},
{	224165	,	1713092	},
{	224165	,	244932	},
{	1450630	,	256325	},
{	224165	,	1596814	},
{	1272458	,	1691664	},
{	1883328	,	1924437	},
{	224165	,	1968767	},
{	374234	,	772096	},
{	224165	,	830322	},
{	909456	,	730420	},
{	1272458	,	924638	},
{	224165	,	1808283	},
{	1890552	,	1948938	},
{	1813171	,	1875646	},
{	224165	,	1555471	},
{	308724	,	1835093	},
{	374234	,	1992103	},
{	1834139	,	686961	},
{	1077691	,	1992180	},
{	101167	,	1653623	},
{	1878275	,	622487	},
{	909456	,	1742120	},
{	101167	,	1751921	},
{	374234	,	1704678	},
{	224165	,	1810560	},
{	240130	,	1139554	},
{	899178	,	1781565	},
{	1890552	,	461125	},
{	1890552	,	1868362	},
{	899178	,	1934415	},
{	308724	,	922828	},
{	240130	,	1988690	},
{	1834139	,	1878919	},
{	995023	,	1527201	},
{	1272458	,	1427211	},
{	240130	,	1964530	},
{	374234	,	1980199	},
{	374234	,	1964925	},
{	988717	,	1606012	},
{	224165	,	1167539	},
{	1077691	,	1636183	},
{	1067052	,	1481374	},
{	240130	,	1952969	},
{	1450630	,	1834139	},
{	909456	,	1011104	},
{	240130	,	1776895	},
{	166912	,	1681471	},
{	374234	,	193651	},
{	1077691	,	1770305	},
{	240130	,	1927634	},
{	240130	,	1707242	},
{	1450630	,	1969702	},
{	1944442	,	1451470	},
{	240130	,	1866847	},
{	1077691	,	1980548	},
{	1077691	,	1973237	},
{	240130	,	1713629	},
{	240130	,	1568422	},
{	1272458	,	1630788	},
{	1834139	,	1834822	},
{	224165	,	1981726	},
{	899178	,	401084	},
{	224165	,	308127	},
{	308724	,	1934989	},
{	1834139	,	1882301	},
{	224165	,	1880150	},
{	1813171	,	1502320	},
{	1272458	,	470760	},
{	1450630	,	1524373	},
{	166912	,	1956702	},
{	1873244	,	1145002	},
{	909456	,	1903416	},
{	1878275	,	256894	},
{	1077691	,	1473957	},
{	240130	,	211518	},
{	1834139	,	1554357	},
{	1067052	,	1854771	},
{	308724	,	240830	},
{	909456	,	1010156	},
{	240130	,	1788477	},
{	240130	,	1983175	},
{	1883328	,	1981790	},
{	1883328	,	958009	},
{	909456	,	867784	},
{	240130	,	1975944	},
{	240130	,	1979706	},
{	1813171	,	965938	},
{	240130	,	1980642	},
{	224165	,	1994685	},
{	240130	,	748947	},
{	224165	,	1826566	},
{	1813171	,	1624365	},
{	240130	,	361004	},
{	899178	,	1481330	},
{	240130	,	1475410	},
{	166912	,	994990	},
{	909456	,	1978808	},
{	240130	,	1142060	},
{	1450630	,	1262285	},
{	1450630	,	1951711	},
{	1873244	,	1920641	},
{	1873244	,	1855051	},
{	224165	,	268570	},
{	1450630	,	1959885	},
{	240130	,	1993438	},
{	1813171	,	1954422	},
{	1272458	,	1976322	},
{	1450630	,	360373	},
{	240130	,	1494554	},
{	240130	,	1630235	},
{	909456	,	1366050	},
{	308724	,	1921567	},
{	1077691	,	1808934	},
{	909456	,	680529	},
{	224165	,	1919877	},
{	240130	,	1950685	},
{	899178	,	1986567	},
{	1272458	,	1191088	},
{	374234	,	198005	},
{	224165	,	1093726	},
{	100923	,	1450630	},
{	308724	,	639031	},
{	909456	,	1323400	},
{	224165	,	595185	},
{	374234	,	249075	},
{	374234	,	1743356	},
{	240130	,	984521	},
{	160996	,	1755736	},
{	166912	,	1873694	},
{	899178	,	1956992	},
{	1272458	,	1995312	},
{	374234	,	625440	},
{	240130	,	1467312	},
{	1450630	,	1303495	},
{	240130	,	1929732	},
{	1834139	,	763317	},
{	240130	,	191367	},
{	374234	,	1843827	},
{	1077691	,	1767553	},
{	909456	,	1995756	},
{	988717	,	1799716	},
{	1272458	,	1995615	},
{	224165	,	503975	},
{	1450630	,	363043	},
{	240130	,	1776697	},
{	1450630	,	1939166	},
{	1834139	,	1986724	},
{	374234	,	1793317	},
{	240130	,	1960128	},
{	101167	,	1979949	},
{	614469	,	1719223	},
{	101167	,	906326	},
{	240130	,	1887136	},
{	357045	,	1881773	},
{	240130	,	1616885	},
{	1272458	,	1934260	},
{	909456	,	1611508	},
{	240130	,	1995878	},
{	224165	,	1875185	},
{	308724	,	1146046	},
{	899178	,	1909511	},
{	1450630	,	1677345	},
{	240130	,	1609656	},
{	160996	,	303291	},
{	1876052	,	1925120	},
{	1272458	,	1624224	},
{	374234	,	1114502	},
{	1272458	,	1524224	},
{	909456	,	1128726	},
{	1272458	,	1731138	},
{	909456	,	1935150	},
{	374234	,	389417	},
{	909456	,	1996830	},
{	909456	,	388298	},
{	909456	,	1960132	},
{	909456	,	435927	},
{	909456	,	1944318	},
{	909456	,	1346996	},

}

function fixbind()
	for i = 1,#tab_fix do
		local tab_info = tab_fix[i]
		local account = tab_info[2]
		local bind_account = tab_info[1]

		local int_silver_service_account = get_temp_attr(account, "silService")
		if not int_silver_service_account then
			--set_temp_attr(account, "silService", bind_account, 30*86400, true)
			print("绑定", account, bind_account)
		end
	end
end

local ok, err = pcall(fixbind)
if not ok then
	print(err)
else
	print("执行完毕", time.date(os.time()))
end

activity_redis:quit()
